　'Kosugi', 'Noto Serif JP' 共にルビ文字の大きさは元の文字の大きさのちょうど半分。

　ルビの問題が不確定要素といっても、一行の最大文字数を下回ることはあっても超えることはない。
　だから行あたりの文字数から最低どこくらいのスケールをとるのかは計算可能。

　すべての行を最大文字数毎に分割していたら処理が膨大になってしまうので、
　ページをオーバーした行だけ検出して分割し、次のページに送る方式が良いと思う。